#!/usr/bin/env sage3
# -*- coding: utf-8 -*-
from sage.all_cmdline import *

"""Defines a string of all possible characters to be converted"""
symbols = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n:;,.!?()@- "

"""Returns numeric representation of a string composed of convertible characters"""
def str2num(s):
	digits = [symbols.find(c) for c in s]
	return ZZ(digits,len(symbols))

"""Generates string out of number with characters from symbols"""
def num2str(n):
	s = ''.join([symbols[digit] for digit in n.digits(len(symbols))])
	return s
	
N = [17954293635344402078832763709919520633281647633814760249567217240472080812749359406279132665387837467214630144331319665364134651952898104706635463338293817378695020836410984759318903460364546992419069097700485279600978325927051101020408619207243108222211227532731979369479366274539825440420522226536191244882070601, 25780363426096426603506419129758530749747517704093681150279611054993558532456357842440446646649657508710948261300888003156540781432902454371870063427294241528312140571472672775454548234518151829726812941850117593126462806906716788230158318270837725371147872337433030684953730516222510140382109884659797938002421543, 24529767114258672712457409904225503496219924062618329721127839071334140499544463000232678896275411200496676998527882370321105985202770294011077814384818012104924062863936782279876300633054583347506907062435593136065939917612693230262855305688325810610608115685118460399637617528116084469974011985995765149990595089, 21555765350338532685616172506397255452038118581660364265955455932817383525712445564192099111352192193717524501048122757881183451358647331896776543358730201050232104889053326793803880419598570640061023564898796129072846064186600608736677624325099045986309761941518626008941080397668402256008885993657853880384448127, 36698862414881633282760953605491708836118720683032401132339906333049331627626107824571433936891290454618112547593569027586894379230746798781093981384221800480563301666562085598669750624880500046424544528322873684031703534792528703940804315467782845410926852585826365579369099024139757924643166257799614594004940317, 25496079866079690851945539234991718732393115898364266639467738967424214631712456794593724047804687221763954558049370620069621866912523933738995948813522828191207991225455311801141313493589857853527487288527525615575735355905038450839373283337559503617529728556373240449617988043152854733424590878772280233434798497, 24487858163027727112914835119051132735975864104573488712602379489200974771532442537150262994314368937524863795499495572373807922207936996107768006305291407454180523825647251297963785197860465423172230899921877481095297271385635886932534499172863162976533300366371446772969015826592270747282358558574505029296947319, 35750321689795467246357956063276273011832199720192584735642631807490144222072037449173348453558057276412187324796729272157143753335741674594285905575298241879483722354551539315337204265500349911414687606523502685350033519458561325913428002543185405871867070338078219226096944864728913815923328083845221560973394827, 21548250449800187307146218602050679239838771214262414678014619367811965050059338279138984457516005571425304535176876167275815844236896192596012127434214585626438777958771484046241589673503989519423128496005067410566580974361074795602147776186285009358252318843685539488270826532410455733403135557266275674775877371, 20522553370499959299049073933255710128205915978655526760975013763183164346468867083090097418582755457629113862967011739268200207890617520474593308195094939462646933830042575648302935034437102891420267509187018607441865209255035292482371214847176887844664898317874373273650729119105072761680837970862583984283274781, 25326715762803076483320105537451326902685714005528248106788074175718921871466430173208142390892086097263742935584171340592478832030336834253002236187087111309309788333854664457311988697795155294401428160838346848108085468732289193228540020539845770606214730375433889344231026171963673626294329250323240035304283231, 18811483841363124044444635946549203692152815515353718561472616348675573382798900465810463443689723127445574610539745663882866662622221584781847349056059963247288764607528739544864950150108187132005575383400419002793646978110282470879372853097259067169257457670759517272478786120809103694601291053659362730311760931, 18563568727396639999388378554311201296890015543620919303695179498572987226274156619268928817226635258420687087169962371846718312487421622629129716775605378239602928518514065396505220918895163391669682116148361339253636118137954222633824548559114783826937501079136520811230878309819680026824499838658719817374126487, 19587875703341787123091970867982875130570973762088099141596708001143029491193873907339150503431473647907642924762090576747885895310827957369604193395252946277523846647175008173490098196847195751922126499421033064483229944640272904737744358842666879278332105003413093983181246823200292858447261198847342703835871921, 19002458948453004721789676737380233717584285608936252581967377198350660855063236153408755206133275895418150431178414564017945831558463049994481708603900397349080601229629399647664593500052644011826277548184178651413203315391185108894879144455462876093051985292574150861629596357448731619690399337447473538575776751, 34383530386537921464786244075215524101327791763283850613012688983622364692477832102256355343515434266379175376253827277186133971568783417894314220353237872039602112284890973960052222399116390125817706796850200023776245676897852951259254520125066527030253547025920154172786773703323106550556161108142141390998557717, 18343913580986445014931350148222760400541501323711675253789299789446374942460760291075881616504205705797319401766351618048443952851399458664164798277155520841804770464258775790074422217276676698508932039305107716509867128934161166937544480929114401384878734388072972174388699798955538479805310086555992984532370859] 
C = [3159134616521573739378771766024132073078481961931383620518315348191821843216798690677183746587920297796083707721078527898427317156965595332793896313243384265598621390867112039036276965532470564545515495314924703953630690087524607918573122899477431237109574557935461616712242398485380810961622118498245876661128681, 9476237821101174865435342512684280954727352656390218066227235351797330209374255787540553853688070541435385929533657306919947875236104770346932852668460316536695373087067478560609303006784482061368504242226156941477337123527543056067672954467755177661608284167698989199055599938261531948593197589063085848629317339, 7335963217884282779453272427415366909277011626242134274471040418558506461346371904368266542548903754979865663975234166776905179927295784565279013619056390396234177043822625447729773904904707497754216433306358200873728096914949154543811097843915664360546287679157046503613178830071959455905524578947527954288742367, 21283334366729377702699098995238199630715398890833901438243729330970570596986379803742222424374834702448268945020362240984107789341748352567570571592470161525299750542152144706408777385299774047613784120597179579279848618028523991839551010932069375697015287512279753983710601232041443153919726986992967476492016604, 10382290760431124476561643369359887160214435726193634730041575256450043554780767978347226180387907517907834905203885767230647155394679011637316829035963449712232443165206711539741658462644132631839662878368395622078880830327292112701430490279907923567342384690137017048399217550049557427253317807887574787879336179, 23348613734320327102854109426355418875733312815609124598609853774079252900628723486742360199382243874135489252252523957350626213076769865022734609453821812165836507170647112531275359945085648832889156175541826172763603986771800111420648083673970592714697232281763989480694927632697416154936661597757141536343686701, 3578516546694372939204433330058849476656912881819047142851659621925255828578774891339784922031043716609066568774498499874040019481153921087587442273603284283060332371466831376895577949432648285934399243018948660764334161227034132701868693499405500206815930983967421279313304483813712641789137973340657347287985153, 23425790336537887722427622896850512461835725097940046071310808506837970316314139500270118211705464064716660811427580719682345122216862950353735898140563819401868902340134622094967942291916291455456548089560069473171875786608885865748384434830503464822497780415246359646095027046489305431511025131835839037087627874, 17157778107927906038195009876858287885877305772015357091048364274611737254675715663883948541560486119928879478682729849000609829596708176846185751625897829334496382031976202380766774755939107180721608845438940804953580714513832813448978099296874095195226084539854507378261591232257511974871854192636810367130713714, 4736762404976669901010154181502297922100566568504660800125433155003687350882334893774701690821823695702405832601635891807645054742432055088095672439273099595590229500235582082134918185442891476817423642449573432565488531732265352029468111751065465911183923264477183830856879151523595797003622791392553531056203472, 17905482873942600436093880967626681473370412780665715863363649964372684212997210127778830285223241179705351106748286998987767520087120952899322319876024326447398750325592805506446311082676391215310041392004241408920666287636511446557976297367536672361760602752382884923123691850951835775147859927584402071456699014, 6248552128061898225574870106190310648265368369473644908717677432248309692492030104659775265023148891191626636514085555278930558200926698439469847066472954962812467219964610387880558262883606139143152985470761521643149030231212065957022690002840051221196093966117314755559517694549357314720793673194928645269706510, 13064047618023557048720688022552736390284338815439111487439079185405279766479899101803019341171445608258506516873096663966754161034875611181294588205637217448204045431947787828875957199984685852748192089741810134816751014925459752018978714859524531711124010791086702108239976872260098752601139956651535621752745716, 17543839577072061218298382599055223519383080048804064336828629495110085399632614497745163286474836574001538663589072195979018586735669754387866327279787147298002323619632467171076376336981154174569109647876728241175751472796680445095874122590289991057746083098715124818627550026970692406336970754572886466766612548, 10292050432293923928082531660235502224326812307803675611614570771445844912231042794554356191125958959987034971169971349162136511041290086316140113240778577561304037264215324218759301776727288696714356642524064194660809885472494120077093174530189594070238410166320964139660596672817506053791079083482326170984302143, 18118038101924641827692529805689555777799911529656268814406592028188663993175452731695006517588375581525924049478794675315677762265777323725171631261224166556879926895894138511513986519258693302276424158025853755009440899109032211642019870665426539369990820392321392491730308576936635797810481491408720696580527582, 40871007701649587007839927437087336987266799150668922575307804516144167009531069643542833820111906302687906369998639486249965326715497521914403125475728815054295775653052889828762269803463619389535149258543063570439831642160675349857004710136758232089576868111150902494157625236558633602133391032673710118346373] 

# ab hier bitte den Angriff implementieren
e = 17 #Der oeffentliche Exponente
def attack():
    a = crt(C,N) #Loesen das System von Gleichungen mit CRT
    msg = a.nth_root(e) # e-te Wuerzel ziehen
    return msg

def main():
    msg = attack()
    print "Flag: {}".format(num2str(msg))
if __name__ == '__main__':
    main()
